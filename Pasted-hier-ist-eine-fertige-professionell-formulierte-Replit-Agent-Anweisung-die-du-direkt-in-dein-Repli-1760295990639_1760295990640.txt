hier ist eine fertige, professionell formulierte Replit-Agent-Anweisung, die du direkt in dein Replit-Chatfeld einfÃ¼gen kannst.
Sie ist so aufgebaut, dass der Agent sofort weiÃŸ, was zu tun ist, in welcher Reihenfolge und wie er den Fix verifizieren soll.
Alle relevanten Hypothesen aus deiner Analyse sind integriert.

ğŸ§  Replit-Agent Prompt: Radix UI Select Runtime Error Fix

Kontext:
Im Projekt tritt beim Ã–ffnen der Dropdown-MenÃ¼s (â€Kategorie-Filterâ€œ und â€Aufgaben-Auswahlâ€œ) im Tab "Kreativ" ein Runtime Error auf:
[plugin:runtime-error-plugin] (unknown runtime error)

Ziel: Ursache finden und stabilen Fix implementieren.

ğŸ” 1. Reproduzieren & Diagnose

Ã–ffne client/src/pages/student-detail.tsx

Reproduziere den Fehler (Dropdown im Tab â€Kreativâ€œ Ã¶ffnen).

PrÃ¼fe Browser-Konsole: BestÃ¤tige, dass der Error beim Ã–ffnen, nicht beim AuswÃ¤hlen, ausgelÃ¶st wird.

FÃ¼ge temporÃ¤r einen Log im Select-Render hinzu, um Datenfluss zu prÃ¼fen:

console.log("Render SelectContent", {
  selectedCategory,
  selectedTaskId,
  availableCreativeTasksLength: availableCreativeTasks?.length
});


â†’ So sehen wir, ob undefined oder leere Arrays reinlaufen.

âš™ï¸ 2. Vereinheitliche kontrolliertes State-Handling

Ziel: Kein Mix aus defaultValue und value, um Radix-Internal Crash zu vermeiden.

a) Kategorie-Filter (client/src/pages/student-detail.tsx, ca. Zeile 680)
<Select
  value={selectedCategory}
  onValueChange={(value) => {
    setSelectedCategory(value);
    setSelectedTaskId(undefined);
  }}
>


â¡ï¸ Entferne defaultValue="all".

b) Aufgaben-Auswahl
<Select
  value={selectedTaskId ?? ""}
  onValueChange={(value) => setSelectedTaskId(value || undefined)}
>


â¡ï¸ Stelle sicher, dass der value nie undefined ist, sondern "".

ğŸ§© 3. Sicheres Fallback-Item statt leerem Content

Ersetze die bisherige dynamische SelectContent-Struktur mit dieser:

const filteredTasks = availableCreativeTasks.filter(
  (task) => selectedCategory === "all" || task.category === selectedCategory
);

<SelectContent>
  {filteredTasks.length === 0 ? (
    <SelectItem disabled value="none">
      Keine Aufgaben in dieser Kategorie
    </SelectItem>
  ) : (
    filteredTasks.map((task) => (
      <SelectItem key={task.id} value={task.id}>
        {task.title}
      </SelectItem>
    ))
  )}
</SelectContent>


â¡ï¸ Kein leerer <SelectContent>, kein doppeltes .filter(), keine Portal-Crashs.

ğŸª„ 4. Portal-Ziel fixieren (bekannter Radix-Bug)

Ã–ffne:
client/src/components/ui/select.tsx

Suche den Part, wo das SelectContent-Element gerendert wird.
Wenn dort kein explizites Portal angegeben ist, ersetze mit:

<Select.Portal container={document.body}>
  <Select.Content position="popper">{children}</Select.Content>
</Select.Portal>


â¡ï¸ Verhindert Portal-Mount-Konflikte, wenn Tabs oder modale Views geÃ¶ffnet/geschlossen werden.

ğŸ§± 5. Defensive Guards gegen ungÃ¼ltige Values

PrÃ¼fe alle onValueChange-Handler im File:

onValueChange={(value) => {
  if (!value || value === "none") return;
  setSelectedTaskId(value);
}}


â¡ï¸ Damit keine leeren Strings oder undefined in Radix gelangen.

ğŸ§© 6. Timing Guard fÃ¼r Query-Daten

In der Renderfunktion:

if (!availableCreativeTasks) {
  return <div>Lade kreative Aufgaben...</div>;
}


oder:

<Select disabled={availableCreativeTasks.length === 0}>


â¡ï¸ Radix initialisiert nicht mit undefined-Items.

ğŸ”„ 7. Test & Validierung

App neu starten.

Im Kreativ-Tab Dropdown Ã¶ffnen.

Kein Runtime Error beim Ã–ffnen âœ…

Kategorie-Filter funktioniert korrekt âœ…

Keine Warnung wegen value/defaultValue im Log âœ…

Teste Zustandwechsel (setSelectedCategory, setSelectedTaskId) Ã¼ber React DevTools.

ğŸ“¦ 8. Version Check & Finales Upgrade (wenn Problem bleibt)

FÃ¼hre im Terminal aus:

npm ls @radix-ui/react-select


Wenn Version < 2.0.0, dann:

npm install @radix-ui/react-select@^2.0.0


â¡ï¸ Version 2.x behebt mehrere Portal-Rendering-Fehler.

âœ… Erfolgskriterien

Kein [plugin:runtime-error-plugin] mehr beim Ã–ffnen eines Select.

Dropdown Ã¶ffnet und zeigt Inhalte korrekt.

Kein Value- oder Portal-bezogener Warning mehr in der Console.

Controlled-State-Flow stabil zwischen Kategorie-Filter und Aufgaben-Auswahl.